use crate::models::companies_model::Company;
use crate::models::forecast_models::Forecasts;
use crate::models::metrics_model::{CurrentMetrics, Trend};
use chrono::NaiveDate;
use serde::Serialize;

#[derive(Serialize)]
#[serde(rename_all = "camelCase")]
pub struct ReturningModel {
    company_name: String,
    industry: String,
    exchange: String,
    ticker: String,
    currency: String,
    net_interest_income_growth_yoy_ttm: Option<f64>,
    net_interest_income_growth_multi_year: Option<f64>,
    net_interest_margin_ttm: Option<f64>,
    net_interest_margin_short_term_trend: Option<Trend>,
    net_interest_margin_long_term_trend: Option<Trend>,
    cost_of_risk_ttm: Option<f64>,
    cost_of_risk_short_term_trend: Option<Trend>,
    cost_of_risk_long_term_trend: Option<Trend>,
    revenue_ttm: Option<f64>,
    revenue_growth_yoy_ttm: Option<f64>,
    revenue_growth_multi_year: Option<f64>,
    gross_profit_growth_yoy_ttm: Option<f64>,
    gross_profit_growth_multi_year: Option<f64>,
    gross_margin_ttm: Option<f64>,
    gross_margin_short_term_trend: Option<Trend>,
    gross_margin_long_term_trend: Option<Trend>,
    sga_ratio_ttm: Option<f64>,
    sga_short_term_trend: Option<Trend>,
    sga_long_term_trend: Option<Trend>,
    rnd_ratio_ttm: Option<f64>,
    rnd_short_term_trend: Option<Trend>,
    rnd_long_term_trend: Option<Trend>,
    operating_margin_ttm: Option<f64>,
    operating_margin_short_term_trend: Option<Trend>,
    operating_margin_long_term_trend: Option<Trend>,
    interest_expense_ratio_ttm: Option<f64>,
    net_margin_ttm: Option<f64>,
    theoretical_net_margin: Option<f64>,
    is_net_margin_optimized: Option<bool>,
    shares_outstanding_diluted_ttm: Option<f64>,
    shares_change_ttm: Option<f64>,
    shares_change_multi_year: Option<f64>,
    shares_change_trend: Option<Trend>,
    retained_earnings_ttm: Option<f64>,
    retained_earnings_trend: Option<Trend>,
    net_cash_ttm: Option<f64>,
    has_healthy_net_cash: Option<bool>,
    net_cash_trend: Option<Trend>,
    operating_cash_flow_ttm: Option<f64>,
    operating_cash_flow_margin_ttm: Option<f64>,
    operating_cash_flow_margin_trend: Option<Trend>,
    free_cash_flow_ttm: Option<f64>,
    free_cash_flow_margin_ttm: Option<f64>,
    ffo_margin_ttm: Option<f64>,
    ffo_margin_trend: Option<Trend>,
    next_earnings_date: Option<NaiveDate>,
    latest_price: Option<f64>,
    last_updated: Option<NaiveDate>,
    revenue_next_year: Option<f64>,
    revenue_growth_next_year: Option<f64>,
    price_current_revenue_growth: Option<f64>,
    price_current_gp_growth: Option<f64>,
    price_next_year_revenue_growth: Option<f64>,
    price_multi_year_revenue_growth: Option<f64>,
    price_multi_year_gp_growth: Option<f64>,
}

impl ReturningModel {
    pub fn new(company: Company, metrics: CurrentMetrics, forecasts: Forecasts) -> Self {
        ReturningModel {
            company_name: company.company_name,
            industry: company.industry,
            exchange: company.exchange,
            ticker: company.ticker,
            currency: metrics.currency,
            net_interest_income_growth_yoy_ttm: metrics.net_interest_income_growth_yoy_ttm,
            net_interest_income_growth_multi_year: metrics.net_interest_income_growth_multi_year,
            net_interest_margin_ttm: metrics.net_interest_margin_ttm,
            net_interest_margin_short_term_trend: metrics.net_interest_margin_short_term_trend,
            net_interest_margin_long_term_trend: metrics.net_interest_margin_long_term_trend,
            cost_of_risk_ttm: metrics.cost_of_risk_ttm,
            cost_of_risk_short_term_trend: metrics.cost_of_risk_short_term_trend,
            cost_of_risk_long_term_trend: metrics.cost_of_risk_long_term_trend,
            revenue_ttm: metrics.revenue_ttm,
            revenue_growth_yoy_ttm: metrics.revenue_growth_yoy_ttm,
            revenue_growth_multi_year: metrics.revenue_growth_multi_year,
            gross_profit_growth_yoy_ttm: metrics.gross_profit_growth_yoy_ttm,
            gross_profit_growth_multi_year: metrics.gross_profit_growth_multi_year,
            gross_margin_ttm: metrics.gross_margin_ttm,
            gross_margin_short_term_trend: metrics.gross_margin_short_term_trend,
            gross_margin_long_term_trend: metrics.gross_margin_long_term_trend,
            sga_ratio_ttm: metrics.sga_ratio_ttm,
            sga_short_term_trend: metrics.sga_short_term_trend,
            sga_long_term_trend: metrics.sga_long_term_trend,
            rnd_ratio_ttm: metrics.rnd_ratio_ttm,
            rnd_short_term_trend: metrics.rnd_short_term_trend,
            rnd_long_term_trend: metrics.rnd_long_term_trend,
            operating_margin_ttm: metrics.operating_margin_ttm,
            operating_margin_short_term_trend: metrics.operating_margin_short_term_trend,
            operating_margin_long_term_trend: metrics.operating_margin_long_term_trend,
            interest_expense_ratio_ttm: metrics.interest_expense_ratio_ttm,
            net_margin_ttm: metrics.net_margin_ttm,
            theoretical_net_margin: metrics.theoretical_net_margin,
            is_net_margin_optimized: metrics.is_net_margin_optimized,
            shares_outstanding_diluted_ttm: metrics.shares_outstanding_diluted_ttm,
            shares_change_ttm: metrics.shares_change_ttm,
            shares_change_multi_year: metrics.shares_change_multi_year,
            shares_change_trend: metrics.shares_change_trend,
            retained_earnings_ttm: metrics.retained_earnings_ttm,
            retained_earnings_trend: metrics.retained_earnings_trend,
            net_cash_ttm: metrics.net_cash_ttm,
            has_healthy_net_cash: metrics.has_healthy_net_cash,
            net_cash_trend: metrics.net_cash_trend,
            operating_cash_flow_ttm: metrics.operating_cash_flow_ttm,
            operating_cash_flow_margin_ttm: metrics.operating_cash_flow_margin_ttm,
            operating_cash_flow_margin_trend: metrics.operating_cash_flow_margin_trend,
            free_cash_flow_ttm: metrics.free_cash_flow_ttm,
            free_cash_flow_margin_ttm: metrics.free_cash_flow_margin_ttm,
            ffo_margin_ttm: metrics.ffo_margin_ttm,
            ffo_margin_trend: metrics.ffo_margin_trend,
            next_earnings_date: forecasts.next_earnings_date,
            latest_price: forecasts.latest_price,
            last_updated: forecasts.last_updated,
            revenue_next_year: forecasts.revenue_next_year,
            revenue_growth_next_year: forecasts.revenue_growth_next_year,
            price_current_revenue_growth: forecasts.price_current_revenue_growth,
            price_current_gp_growth: forecasts.price_current_gp_growth,
            price_next_year_revenue_growth: forecasts.price_next_year_revenue_growth,
            price_multi_year_revenue_growth: forecasts.price_multi_year_revenue_growth,
            price_multi_year_gp_growth: forecasts.price_multi_year_gp_growth,
        }
    }
}
